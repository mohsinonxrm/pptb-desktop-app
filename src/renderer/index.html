<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self'; img-src 'self' data: pptb-webview: https://github.com https://*.githubusercontent.com https://*.supabase.co https://*.blob.core.windows.net; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self' https://api.github.com https://raw.githubusercontent.com https://*.crm.dynamics.com https://*.supabase.co; frame-src 'self' pptb-webview:"
        />
        <title>Power Platform ToolBox</title>
        <link rel="stylesheet" href="styles.scss" />
    </head>
    <body>
        <div class="app-container">
            <!-- Activity Bar (PPTB-style narrow sidebar) -->
            <aside class="activity-bar" id="activity-bar">
                <div class="activity-bar-header">
                    <div class="app-icon" title="Power Platform ToolBox">
                        <img id="app-icon-img" src="icons/dark/app-icon.svg" alt="App Icon" />
                    </div>
                </div>
                <nav class="activity-bar-nav">
                    <button class="activity-item active" data-sidebar="tools" title="Installed Tools">
                        <img id="tools-icon" src="icons/dark/tools.svg" alt="Tools Icon" class="activity-icon" />
                    </button>
                    <button class="activity-item" data-sidebar="connections" title="Connection Manager">
                        <img id="connections-icon" src="icons/dark/connections.svg" alt="Connections Icon" class="activity-icon" />
                    </button>
                    <button class="activity-item" data-sidebar="marketplace" title="Tools Marketplace">
                        <img id="marketplace-icon" src="icons/dark/marketplace.svg" alt="Marketplace Icon" class="activity-icon" />
                    </button>
                    <button class="activity-item" id="global-search-btn" title="Global Search (Ctrl+Shift+P)">
                        <img id="search-icon" src="icons/dark/search.svg" alt="Search Icon" class="activity-icon" />
                    </button>
                    <button class="activity-item" data-sidebar="debug" title="Debug / Install by Package">
                        <img id="debug-icon" src="icons/dark/debug.svg" alt="Debug Icon" class="activity-icon" />
                    </button>
                </nav>
                <nav class="activity-bar-footer">
                    <button class="activity-item" data-sidebar="settings" title="Settings">
                        <img id="settings-icon" src="icons/dark/settings.svg" alt="Settings Icon" class="activity-icon" />
                    </button>
                </nav>
            </aside>

            <!-- Sidebar (context-sensitive based on Activity Bar selection) -->
            <aside class="sidebar" id="sidebar">
                <!-- Tools Sidebar -->
                <div class="sidebar-content active" id="sidebar-tools">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">INSTALLED</h2>
                    </div>
                    <div class="sidebar-search-bar">
                        <input type="text" id="tools-search-input" class="search-input" placeholder="Search installed tools..." />
                        <button class="search-filter-btn" id="tools-filter-btn" title="Filters and Sort">
                            <img width="16" height="16" alt="Filter Icon" />
                        </button>
                    </div>
                    <div class="filter-dropdown" id="tools-filter-dropdown" style="display: none">
                        <div class="filter-section">
                            <div class="filter-section-title">Sort By</div>
                            <select id="tools-sort-select" class="filter-dropdown-select">
                                <option value="favorite">Favorite</option>
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="popularity">Popularity</option>
                                <option value="rating">Highly Rated</option>
                                <option value="downloads">Most Downloaded</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Category</div>
                            <select id="tools-category-filter" class="filter-dropdown-select">
                                <option value="">All Categories</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Author</div>
                            <select id="tools-author-filter" class="filter-dropdown-select">
                                <option value="">All Authors</option>
                            </select>
                        </div>
                    </div>
                    <div class="sidebar-body">
                        <div class="tools-list-pptb" id="sidebar-tools-list">
                            <!-- Tools will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Connections Sidebar -->
                <div class="sidebar-content" id="sidebar-connections">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">CONNECTIONS</h2>
                        <button id="sidebar-add-connection-btn" class="fluent-button fluent-button-primary">+ Add</button>
                    </div>
                    <div class="sidebar-search-bar">
                        <input type="text" id="connections-search-input" class="search-input" placeholder="Search connections..." />
                        <button class="search-filter-btn" id="connections-filter-btn" title="Filters and Sort">
                            <img width="16" height="16" alt="Filter Icon" />
                        </button>
                    </div>
                    <div class="filter-dropdown" id="connections-filter-dropdown" style="display: none">
                        <div class="filter-section">
                            <div class="filter-section-title">Sort By</div>
                            <select id="connections-sort-select" class="filter-dropdown-select">
                                <option value="last-used">Last Used</option>
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="environment">Environment Type</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Environment</div>
                            <select id="connections-environment-filter" class="filter-dropdown-select">
                                <option value="">All Environments</option>
                                <option value="Dev">Dev</option>
                                <option value="Test">Test</option>
                                <option value="UAT">UAT</option>
                                <option value="Production">Production</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Authentication Type</div>
                            <select id="connections-auth-filter" class="filter-dropdown-select">
                                <option value="">All Auth Types</option>
                                <option value="interactive">Microsoft Login</option>
                                <option value="clientSecret">Client Secret</option>
                                <option value="usernamePassword">Username/Password</option>
                            </select>
                        </div>
                    </div>
                    <div class="sidebar-body">
                        <div class="connections-list-sidebar" id="sidebar-connections-list">
                            <!-- Connections will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Marketplace Sidebar -->
                <div class="sidebar-content" id="sidebar-marketplace">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">MARKETPLACE</h2>
                    </div>
                    <div class="sidebar-search-bar">
                        <input type="text" id="marketplace-search-input" class="search-input" placeholder="Search tools..." />
                        <button class="search-filter-btn" id="marketplace-filter-btn" title="Filters and Sort">
                            <img width="16" height="16" alt="Filter Icon" />
                        </button>
                    </div>
                    <div class="filter-dropdown" id="marketplace-filter-dropdown" style="display: none">
                        <div class="filter-section">
                            <div class="filter-section-title">Sort By</div>
                            <select id="marketplace-sort-select" class="filter-dropdown-select">
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="popularity">Popularity</option>
                                <option value="rating">Highly Rated</option>
                                <option value="downloads">Most Downloaded</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Category</div>
                            <select id="marketplace-category-filter" class="filter-dropdown-select">
                                <option value="">All Categories</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <div class="filter-section-title">Author</div>
                            <select id="marketplace-author-filter" class="filter-dropdown-select">
                                <option value="">All Authors</option>
                            </select>
                        </div>
                        <div class="filter-divider"></div>
                        <div class="filter-section">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer">
                                <input type="checkbox" id="marketplace-new-filter" style="cursor: pointer" />
                                <span>New (last 7 days)</span>
                            </label>
                        </div>
                    </div>
                    <div class="sidebar-body">
                        <div class="marketplace-tools-list-pptb" id="marketplace-tools-list">
                            <!-- Marketplace tools will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Debug Sidebar -->
                <div class="sidebar-content" id="sidebar-debug">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">DEBUG</h2>
                    </div>
                    <div class="sidebar-body">
                        <div class="debug-container-sidebar">
                            <section class="settings-section-card debug-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Local Development</p>
                                    <p class="settings-section-description">Load a tool directly from your local file system for rapid iteration.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <label class="debug-label" for="sidebar-local-tool-path">Tool Directory Path</label>
                                        <div class="debug-path-input-group">
                                            <input type="text" id="sidebar-local-tool-path" class="fluent-input" placeholder="Select tool directory..." readonly />
                                            <button id="sidebar-browse-local-tool-btn" class="fluent-button fluent-button-secondary">Browse</button>
                                        </div>
                                        <span class="debug-hint">Select the root directory containing your tool's package.json</span>
                                    </div>
                                    <div class="debug-card-actions">
                                        <button id="sidebar-load-local-tool-btn" class="fluent-button fluent-button-primary">Load Tool</button>
                                    </div>
                                </div>
                            </section>

                            <section class="settings-section-card debug-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Registry Install</p>
                                    <p class="settings-section-description">Install a custom tool straight from npm for staging or private builds.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <label class="debug-label" for="sidebar-package-name-input">Package Name</label>
                                        <input type="text" id="sidebar-package-name-input" class="fluent-input" placeholder="e.g., @powerplatform/tool-example" />
                                        <span class="debug-hint">Enter the full npm package name including scope.</span>
                                    </div>
                                    <div class="debug-card-actions">
                                        <button id="sidebar-install-package-btn" class="fluent-button fluent-button-primary">Install Package</button>
                                    </div>
                                </div>
                            </section>

                            <section class="settings-section-card debug-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Guidance</p>
                                    <p class="settings-section-description">Quick reminders to keep testing safe and efficient.</p>
                                </div>
                                <div class="settings-section-body">
                                    <ul class="debug-info-list">
                                        <li>üìÇ Local Tool: Load directly from your filesystem‚Äîno publishing required.</li>
                                        <li>üîÑ Watch Mode: Build with watch mode, then reload ToolBox to see changes.</li>
                                        <li>üì¶ npm Package: Install published packages for testing or private use.</li>
                                        <li>‚ö†Ô∏è Security: Only load or install tools you trust.</li>
                                    </ul>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>

                <!-- Settings Sidebar -->
                <div class="sidebar-content" id="sidebar-settings">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">SETTINGS</h2>
                    </div>
                    <div class="sidebar-body">
                        <div class="settings-container-sidebar">
                            <section class="settings-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Appearance</p>
                                    <p class="settings-section-description">Choose how ToolBox matches your OS or lock it to a specific look.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <label class="setting-label" for="sidebar-theme-select">Theme</label>
                                        <select id="sidebar-theme-select" class="fluent-select">
                                            <option value="system">System</option>
                                            <option value="light">Light</option>
                                            <option value="dark">Dark</option>
                                        </select>
                                    </div>
                                </div>
                            </section>

                            <section class="settings-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Behavior</p>
                                    <p class="settings-section-description">Fine-tune how ToolBox surfaces menus and deprecated tools.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <div class="settings-field-header">
                                            <div>
                                                <label class="setting-label" for="sidebar-show-debug-menu-check">Show Debug Menu</label>
                                                <span class="setting-hint">Expose the Debug activity to quickly test tools</span>
                                            </div>
                                            <div class="setting-checkbox-group">
                                                <input type="checkbox" id="sidebar-show-debug-menu-check" class="fluent-checkbox" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="settings-field">
                                        <label class="setting-label" for="sidebar-deprecated-tools-select">Deprecated Tools</label>
                                        <select id="sidebar-deprecated-tools-select" class="fluent-select">
                                            <option value="hide-all">Hide from All</option>
                                            <option value="show-all">Show in All</option>
                                            <option value="show-installed">Show in Installed Tools Only</option>
                                            <option value="show-marketplace">Show in Marketplace Only</option>
                                        </select>
                                        <span class="setting-hint">Control when deprecated tools appear across the experience.</span>
                                    </div>
                                    <div class="settings-field">
                                        <label class="setting-label" for="sidebar-tool-display-mode-select">Tool Display Mode</label>
                                        <select id="sidebar-tool-display-mode-select" class="fluent-select">
                                            <option value="standard">Standard</option>
                                            <option value="compact">Compact</option>
                                        </select>
                                        <span class="setting-hint">Choose how tools are displayed in Installed Tools and Marketplace.</span>
                                    </div>
                                </div>
                            </section>

                            <section class="settings-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Terminal</p>
                                    <p class="settings-section-description">Pick a monospace font that keeps long log output readable.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <label class="setting-label" for="sidebar-terminal-font-select">Terminal Font</label>
                                        <select id="sidebar-terminal-font-select" class="fluent-select">
                                            <option value="'Consolas', 'Monaco', 'Courier New', monospace">Consolas / Monaco (Default)</option>
                                            <option value="'MesloLGS NF', 'MesloLGS Nerd Font', 'Menlo', 'DejaVu Sans Mono', 'Consolas', monospace">MesloLGS Nerd Font (Recommended)</option>
                                            <option value="'FiraCode Nerd Font', 'FiraCode NF', 'Fira Code', 'Consolas', monospace">FiraCode Nerd Font</option>
                                            <option value="'JetBrainsMono Nerd Font', 'JetBrainsMono NF', 'JetBrains Mono', 'Consolas', monospace">JetBrains Mono Nerd Font</option>
                                            <option value="'CaskaydiaCove Nerd Font', 'CaskaydiaCove NF', 'Cascadia Code', 'Consolas', monospace">CaskaydiaCove Nerd Font (Cascadia)</option>
                                            <option value="'Hack Nerd Font', 'Hack NF', 'Hack', 'Consolas', monospace">Hack Nerd Font</option>
                                            <option value="'UbuntuMono Nerd Font', 'UbuntuMono NF', 'Ubuntu Mono', 'Consolas', monospace">Ubuntu Mono Nerd Font</option>
                                            <option value="'SourceCodePro Nerd Font', 'SauceCodePro NF', 'Source Code Pro', 'Consolas', monospace">Source Code Pro Nerd Font</option>
                                            <option value="'JetBrains Mono', 'Consolas', monospace">JetBrains Mono</option>
                                            <option value="'Fira Code', 'Consolas', monospace">Fira Code</option>
                                            <option value="'Cascadia Code', 'Consolas', monospace">Cascadia Code</option>
                                            <option value="custom">Custom Font...</option>
                                        </select>
                                    </div>
                                    <div id="custom-font-input-container" class="settings-field" style="display: none">
                                        <label class="setting-label" for="sidebar-terminal-font-custom">Custom Font</label>
                                        <input type="text" id="sidebar-terminal-font-custom" class="fluent-input" placeholder="e.g., 'My Font', monospace" />
                                        <span class="setting-hint">Enter font family CSS value (e.g., 'Font Name', 'Fallback', monospace)</span>
                                    </div>
                                    <span class="setting-hint settings-inline-hint"
                                        >Install fonts locally before selecting them. <a href="#" class="font-help-link" id="font-help-link">Need help installing fonts?</a></span
                                    >
                                </div>
                            </section>

                            <section class="settings-section-card">
                                <div class="settings-section-header">
                                    <p class="settings-section-eyebrow">Updates</p>
                                    <p class="settings-section-description">Check for the latest version of Power Platform ToolBox.</p>
                                </div>
                                <div class="settings-section-body">
                                    <div class="settings-field">
                                        <div class="settings-field-header">
                                            <div>
                                                <label class="setting-label" for="sidebar-auto-update-check">Auto Update</label>
                                                <span class="setting-hint">Automatically check for new builds</span>
                                            </div>
                                            <div class="setting-checkbox-group">
                                                <input type="checkbox" id="sidebar-auto-update-check" class="fluent-checkbox" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="settings-field">
                                        <button id="sidebar-check-for-updates-btn" class="fluent-button fluent-button-secondary">
                                            <span id="check-updates-btn-text">Check for Updates</span>
                                        </button>
                                        <div id="update-status-message" class="setting-hint" style="display: none; margin-top: 8px"></div>
                                    </div>
                                </div>
                            </section>

                            <div class="settings-actions-row">
                                <button id="sidebar-save-settings-btn" class="fluent-button fluent-button-primary">Save Settings</button>
                                <span class="setting-hint">Changes apply instantly after saving.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Tool Panel (for launched tools) -->
                <div id="tool-panel" class="tool-panel" style="display: none">
                    <div class="tool-panel-header">
                        <div class="tool-tabs-container">
                            <button class="tool-tabs-scroll-button tool-tabs-scroll-left" id="scroll-tabs-left" title="Scroll tabs left" aria-label="Scroll tabs left">
                                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M10.072 11.316L6.715 7.96l3.357-3.357-.618-.62-4.667 4.668v.618l4.667 4.667.618-.62z" />
                                </svg>
                            </button>
                            <div class="tool-tabs" id="tool-tabs">
                                <!-- Tabs will be dynamically added here -->
                            </div>
                            <button class="tool-tabs-scroll-button tool-tabs-scroll-right" id="scroll-tabs-right" title="Scroll tabs right" aria-label="Scroll tabs right">
                                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M5.928 11.316l3.357-3.356-3.357-3.357.618-.62 4.667 4.668v.618l-4.667 4.667-.618-.62z" />
                                </svg>
                            </button>
                        </div>
                        <div class="tool-panel-controls">
                            <button class="btn-icon" id="close-all-tools" title="Close all tools">‚úï</button>
                        </div>
                    </div>
                    <div class="tool-panel-content-wrapper" id="tool-panel-content-wrapper">
                        <div class="tool-panel-content" id="tool-panel-content">
                            <!-- BrowserView tools are rendered here by the backend ToolWindowManager -->
                        </div>
                    </div>
                    <!-- Terminal Panel -->
                    <div class="terminal-panel" id="terminal-panel" style="display: none">
                        <div class="terminal-panel-header">
                            <div class="terminal-tabs" id="terminal-tabs">
                                <!-- Terminal tabs will be dynamically added here -->
                            </div>
                            <div class="terminal-panel-controls">
                                <button class="btn-icon" id="terminal-panel-close" title="Hide terminal">
                                    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                        <path d="M8 8.707l3.646 3.647.708-.707L8.707 8l3.647-3.646-.707-.708L8 7.293 4.354 3.646l-.707.708L7.293 8l-3.646 3.646.707.708L8 8.707z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="terminal-panel-content" id="terminal-panel-content">
                            <!-- Terminal outputs will be dynamically added here -->
                        </div>
                    </div>
                    <div class="terminal-resize-handle" id="terminal-resize-handle" style="display: none"></div>
                </div>

                <!-- Home/Welcome View -->
                <div id="home-view" class="view active">
                    <div class="homepage-wrapper">
                        <!-- Hero Section -->
                        <section class="homepage-hero">
                            <div class="homepage-hero-icon">
                                <img id="homepage-app-icon" src="icons/dark/app-icon.svg" alt="Power Platform ToolBox" />
                            </div>
                            <h1 class="homepage-hero-headline">Power Platform ToolBox</h1>
                            <p class="homepage-hero-tagline">A universal desktop app for Power Platform development tools. Build, manage, and deploy with ease.</p>

                            <!-- New Tools Notification Bar -->
                            <div class="new-tools-notification" id="new-tools-notification" style="display: none">
                                <img id="new-tools-icon" class="new-tools-icon" src="icons/dark/star-filled.svg" alt="New tool icon" />
                                <span class="new-tools-label">New!</span>
                                <span class="new-tools-message" id="new-tools-message"></span>
                            </div>

                            <div class="homepage-hero-stats">
                                <div class="hero-stat">
                                    <span class="hero-stat-value" id="stat-installed-count">0</span>
                                    <span class="hero-stat-label">Tools Installed</span>
                                </div>
                                <div class="hero-stat">
                                    <span class="hero-stat-value" id="stat-available-count">0</span>
                                    <span class="hero-stat-label">Available Tools</span>
                                </div>
                                <div class="hero-stat">
                                    <span class="hero-stat-value" id="stat-connections-count">0</span>
                                    <span class="hero-stat-label">Connections</span>
                                </div>
                            </div>
                        </section>

                        <!-- Quick Access Tools Section -->
                        <section class="quick-tools-section">
                            <div class="quick-tools-grid">
                                <!-- Favorite Tools Column -->
                                <div class="quick-tools-column">
                                    <div class="quick-tools-header">
                                        <h3 class="quick-tools-title">‚≠ê Favorite Tools</h3>
                                    </div>
                                    <div class="quick-tools-list" id="favorite-tools-list">
                                        <div class="quick-tools-empty">
                                            <p>No favorite tools yet</p>
                                            <small>Mark tools as favorites to see them here</small>
                                        </div>
                                    </div>
                                </div>

                                <!-- Recently Used Tools Column -->
                                <div class="quick-tools-column">
                                    <div class="quick-tools-header">
                                        <h3 class="quick-tools-title">üïí Recently Used</h3>
                                    </div>
                                    <div class="quick-tools-list" id="recently-used-tools-list">
                                        <div class="quick-tools-empty">
                                            <p>No recently used tools</p>
                                            <small>Launch tools to see them here</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Sponsor CTA Card -->
                        <section class="sponsor-cta-card">
                            <div class="sponsor-cta-header">
                                <span class="sponsor-cta-heart">‚ù§Ô∏è</span>
                                <h2 class="sponsor-cta-title">Support This Project</h2>
                            </div>
                            <p class="sponsor-cta-description">
                                Power Platform ToolBox is free and open source. Your sponsorship helps us maintain and improve the toolbox, add new features, and support the community.
                            </p>
                            <ul class="sponsor-cta-benefits">
                                <li>Provides signed & certified desktop apps for Windows and Mac</li>
                                <li>Help maintain and improve the toolbox</li>
                                <li>Support new feature development</li>
                                <li>Enable better documentation and tutorials</li>
                                <li>Build a stronger Power Platform community</li>
                            </ul>

                            <div class="sponsor-tiers">
                                <div class="sponsor-tier">
                                    <div class="sponsor-tier-name">Supporter</div>
                                    <div class="sponsor-tier-price">$10/mo</div>
                                </div>
                                <div class="sponsor-tier">
                                    <div class="sponsor-tier-name">Contributor</div>
                                    <div class="sponsor-tier-price">$25/mo</div>
                                </div>
                                <div class="sponsor-tier">
                                    <div class="sponsor-tier-name">Advocate</div>
                                    <div class="sponsor-tier-price">$50/mo</div>
                                </div>
                                <div class="sponsor-tier">
                                    <div class="sponsor-tier-name">Champion</div>
                                    <div class="sponsor-tier-price">$100/mo</div>
                                </div>
                            </div>
                            <!--TODO Add later when we have few sponsors-->
                            <!-- <div class="sponsor-stats">
                                <div class="sponsor-count"><strong id="sponsor-count">23</strong> current sponsors</div>
                                <div class="sponsor-avatars">
                                    <div class="sponsor-avatar">üë§</div>
                                    <div class="sponsor-avatar">üë§</div>
                                    <div class="sponsor-avatar">üë§</div>
                                    <div class="sponsor-avatar">+</div>
                                </div>
                            </div> -->

                            <button class="sponsor-cta-button" id="homepage-sponsor-btn">‚ù§Ô∏è Become a Sponsor</button>
                            <a href="#" class="sponsor-one-time" id="homepage-one-time-donation">Or make a one-time donation ‚Üí</a>
                        </section>

                        <!-- What's New Section -->
                        <section class="whats-new-card">
                            <div class="whats-new-header">
                                <h2 class="whats-new-title">What's New</h2>
                                <div class="whats-new-meta">
                                    <span class="release-version" id="release-version">Latest</span>
                                    <span id="release-date">Loading...</span>
                                </div>
                            </div>
                            <ul class="whats-new-highlights" id="release-highlights">
                                <li>üé® Modern VS Code-inspired interface with activity bar and sidebar</li>
                                <li>üîß Install and manage tools from the marketplace</li>
                                <li>üîó Manage multiple Dataverse connections</li>
                                <li>‚öôÔ∏è Customizable settings and themes</li>
                                <li>üîÑ Automatic updates to keep your toolbox current</li>
                            </ul>
                            <a href="#" class="whats-new-link" id="release-full-notes">View full release notes ‚Üí</a>
                        </section>

                        <!-- Quick Actions Grid -->
                        <section class="quick-actions-grid">
                            <div class="quick-action-card" id="quick-action-browse-tools">
                                <div class="quick-action-icon">
                                    <svg width="24" height="24" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                        <path
                                            d="M2.5 2C2.22386 2 2 2.22386 2 2.5V17.5C2 17.7761 2.22386 18 2.5 18H17.5C17.7761 18 18 17.7761 18 17.5V2.5C18 2.22386 17.7761 2 17.5 2H2.5ZM3 3H17V17H3V3ZM5.5 5C5.22386 5 5 5.22386 5 5.5V9.5C5 9.77614 5.22386 10 5.5 10H9.5C9.77614 10 10 9.77614 10 9.5V5.5C10 5.22386 9.77614 5 9.5 5H5.5ZM6 6H9V9H6V6ZM11.5 5C11.2239 5 11 5.22386 11 5.5C11 5.77614 11.2239 6 11.5 6H14.5C14.7761 6 15 5.77614 15 5.5C15 5.22386 14.7761 5 14.5 5H11.5ZM11 7.5C11 7.22386 11.2239 7 11.5 7H14.5C14.7761 7 15 7.22386 15 7.5C15 7.77614 14.7761 8 14.5 8H11.5C11.2239 8 11 7.77614 11 7.5ZM5.5 11C5.22386 11 5 11.2239 5 11.5C5 11.7761 5.22386 12 5.5 12H14.5C14.7761 12 15 11.7761 15 11.5C15 11.2239 14.7761 11 14.5 11H5.5ZM5 13.5C5 13.2239 5.22386 13 5.5 13H14.5C14.7761 13 15 13.2239 15 13.5C15 13.7761 14.7761 14 14.5 14H5.5C5.22386 14 5 13.7761 5 13.5ZM5.5 15C5.22386 15 5 15.2239 5 15.5C5 15.7761 5.22386 16 5.5 16H10.5C10.7761 16 11 15.7761 11 15.5C11 15.2239 10.7761 15 10.5 15H5.5Z"
                                        />
                                    </svg>
                                </div>
                                <p class="quick-action-label">Browse Tools</p>
                            </div>
                            <div class="quick-action-card" id="quick-action-docs">
                                <div class="quick-action-icon">
                                    <svg width="24" height="24" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                        <path
                                            d="M4.5 2C3.67157 2 3 2.67157 3 3.5V16.5C3 17.3284 3.67157 18 4.5 18H15.5C16.3284 18 17 17.3284 17 16.5V6.5C17 6.23478 16.8946 5.98043 16.7071 5.79289L13.2071 2.29289C13.0196 2.10536 12.7652 2 12.5 2H4.5ZM4 3.5C4 3.22386 4.22386 3 4.5 3H12V6.5C12 6.77614 12.2239 7 12.5 7H16V16.5C16 16.7761 15.7761 17 15.5 17H4.5C4.22386 17 4 16.7761 4 16.5V3.5ZM13 3.70711L15.2929 6H13V3.70711ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H14C14.2761 10 14.5 9.77614 14.5 9.5C14.5 9.22386 14.2761 9 14 9H6ZM5.5 11.5C5.5 11.2239 5.72386 11 6 11H14C14.2761 11 14.5 11.2239 14.5 11.5C14.5 11.7761 14.2761 12 14 12H6C5.72386 12 5.5 11.7761 5.5 11.5ZM6 13C5.72386 13 5.5 13.2239 5.5 13.5C5.5 13.7761 5.72386 14 6 14H10C10.2761 14 10.5 13.7761 10.5 13.5C10.5 13.2239 10.2761 13 10 13H6Z"
                                        />
                                    </svg>
                                </div>
                                <p class="quick-action-label">Documentation</p>
                            </div>
                            <div class="quick-action-card" id="quick-action-discord">
                                <div class="quick-action-icon">
                                    <svg width="24" height="24" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                        <path
                                            d="M16.5 3.28c-1.15-.53-2.39-.93-3.69-1.15-.16.29-.34.68-.47.99-1.38-.21-2.74-.21-4.09 0-.12-.31-.31-.7-.47-.99-1.3.22-2.54.62-3.69 1.15C1.52 6.77.96 10.18 1.29 13.54c1.56 1.15 3.07 1.85 4.55 2.31.37-.5.69-1.03.97-1.59-.53-.2-1.04-.45-1.52-.74.13-.09.25-.19.37-.29 2.94 1.36 6.14 1.36 9.04 0 .12.1.24.2.37.29-.48.29-.99.54-1.52.74.28.56.6 1.09.97 1.59 1.48-.46 2.99-1.16 4.55-2.31.39-3.87-.66-7.23-2.79-10.26zM6.68 11.75c-.93 0-1.69-.85-1.69-1.9s.75-1.9 1.69-1.9c.94 0 1.7.85 1.69 1.9.01 1.05-.75 1.9-1.69 1.9zm6.65 0c-.93 0-1.69-.85-1.69-1.9s.75-1.9 1.69-1.9c.94 0 1.7.85 1.69 1.9.01 1.05-.75 1.9-1.69 1.9z"
                                        />
                                    </svg>
                                </div>
                                <p class="quick-action-label">Join Discord</p>
                            </div>
                            <div class="quick-action-card" id="quick-action-github">
                                <div class="quick-action-icon">
                                    <svg width="24" height="24" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                                        <path
                                            d="M10 2a8 8 0 00-2.53 15.59c.4.07.55-.17.55-.38v-1.34c-2.23.49-2.7-1.08-2.7-1.08-.37-.93-.9-1.18-.9-1.18-.73-.5.05-.49.05-.49.81.06 1.24.83 1.24.83.72 1.23 1.88.88 2.34.67.07-.52.28-.88.51-1.08-1.78-.2-3.65-.89-3.65-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.22 2.2.82a7.42 7.42 0 014 0c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.28.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48v2.19c0 .21.15.46.55.38A8 8 0 0010 2z"
                                        />
                                    </svg>
                                </div>
                                <p class="quick-action-label">GitHub</p>
                            </div>
                        </section>

                        <!-- Homepage Footer -->
                        <footer class="homepage-footer">
                            <div class="homepage-footer-links">
                                <a href="#" class="homepage-footer-link" id="footer-tool-submission">Tool Submission</a>
                                <a href="#" class="homepage-footer-link" id="footer-report-bug">Report Bug</a>
                                <a href="#" class="homepage-footer-link" id="footer-request-feature">Request Feature</a>
                                <a href="#" class="homepage-footer-link" id="footer-license">License</a>
                            </div>
                        </footer>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer with connection status -->
        <footer class="app-footer">
            <div class="footer-content">
                <span id="connection-status" class="connection-status">No active connection</span>
            </div>
            <div class="footer-content-right">
                <button type="button" class="fluent-button fluent-button-secondary" id="footer-toggle-terminal-btn" title="Show terminal" aria-pressed="false" aria-hidden="true" hidden>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <rect x="1.75" y="3" width="12.5" height="10" rx="1.5" stroke="currentColor" stroke-width="1" />
                        <path d="M4.5 7.25L6.25 8.75L4.5 10.25" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M7.75 10.75H10.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" />
                    </svg>
                    <span class="footer-terminal-toggle-label">Show Terminal</span>
                </button>
                <span id="secondary-connection-status" class="secondary-connection-status"></span>
            </div>
        </footer>

        <!-- Add Connection Modal -->
        <div id="add-connection-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Dataverse Connection</h3>
                    <button class="modal-close" id="close-connection-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <label for="connection-name">Connection Name:</label>
                    <input class="modal-input" type="text" id="connection-name" placeholder="Production" />

                    <label for="connection-url">Environment URL:</label>
                    <input type="text" id="connection-url" placeholder="https://org.crm.dynamics.com" class="modal-input" />

                    <label for="connection-authentication-type">Authentication Type:</label>
                    <select id="connection-authentication-type" class="modal-input">
                        <option value="interactive">Microsoft Login Prompt</option>
                        <option value="clientSecret">Client ID/Secret</option>
                        <option value="usernamePassword">Username/Password</option>
                    </select>

                    <label for="connection-environment">Environment:</label>
                    <select id="connection-environment" class="modal-input">
                        <option value="Dev">Dev</option>
                        <option value="Test">Test</option>
                        <option value="UAT">UAT</option>
                        <option value="Production">Production</option>
                    </select>

                    <!-- Client ID/Secret fields (hidden by default) -->
                    <div id="client-secret-fields" style="display: none">
                        <label for="connection-client-id">Client ID:</label>
                        <input type="text" id="connection-client-id" placeholder="client-id" class="modal-input" />

                        <label for="connection-client-secret">Client Secret:</label>
                        <div style="position: relative">
                            <input type="password" id="connection-client-secret" placeholder="client-secret" class="modal-input" />
                            <button
                                type="button"
                                class="password-toggle-btn"
                                id="toggle-client-secret"
                                style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer"
                            >
                                üëÅÔ∏è
                            </button>
                        </div>

                        <label for="connection-tenant-id">Tenant ID:</label>
                        <input type="text" id="connection-tenant-id" placeholder="tenant-id" class="modal-input" />
                    </div>

                    <!-- Username/Password fields (hidden by default) -->
                    <div id="username-password-fields" style="display: none">
                        <label for="connection-username">Username:</label>
                        <input type="text" id="connection-username" placeholder="user@domain.com" class="modal-input" />

                        <label for="connection-password">Password:</label>
                        <div style="position: relative">
                            <input type="password" id="connection-password" placeholder="password" class="modal-input" />
                            <button
                                type="button"
                                class="password-toggle-btn"
                                id="toggle-password"
                                style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer"
                            >
                                üëÅÔ∏è
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="test-connection-btn" class="fluent-button fluent-button-secondary" style="display: none; margin-right: auto">Test Connection</button>
                    <button id="cancel-connection-btn" class="fluent-button fluent-button-secondary">Cancel</button>
                    <button id="confirm-connection-btn" class="fluent-button fluent-button-primary">Add</button>
                </div>
            </div>
        </div>

        <!-- Connection Selection Modal -->
        <div id="connection-select-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Select Connection</h3>
                    <button class="modal-close" id="close-connection-select-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Select a connection for this tool:</p>
                    <div id="connection-select-list" class="connection-select-list">
                        <!-- Connections will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="cancel-connection-select-btn" class="fluent-button fluent-button-secondary">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Device Code Modal -->
        <div id="device-code-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Device Authentication</h3>
                </div>
                <div class="modal-body">
                    <p id="device-code-message" style="white-space: pre-wrap; font-family: monospace; background: #f5f5f5; padding: 15px; border-radius: 4px; margin: 10px 0">
                        <!-- Device code message will be displayed here -->
                    </p>
                </div>
                <div class="modal-footer">
                    <button id="close-device-code-btn" class="fluent-button fluent-button-secondary">Close</button>
                </div>
            </div>
        </div>

        <!-- Authentication Error Modal -->
        <div id="auth-error-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Authentication Error</h3>
                    <button class="modal-close" id="close-auth-error-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="auth-error-message" style="color: #d83b01; padding: 15px">
                        <!-- Error message will be displayed here -->
                    </p>
                </div>
                <div class="modal-footer">
                    <button id="close-auth-error-btn" class="fluent-button fluent-button-primary">OK</button>
                </div>
            </div>
        </div>

        <!-- Tool Settings Modal -->
        <div id="tool-settings-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Tool Settings</h3>
                    <button class="modal-close" id="close-tool-settings-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="tool-settings-content">
                        <!-- Tool settings will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="cancel-tool-settings-btn" class="fluent-button fluent-button-secondary">Close</button>
                </div>
            </div>
        </div>

        <!-- Loading Screen Overlay (scoped to active tool) -->
        <div id="loading-screen" class="loading-screen" style="display: none">
            <div class="loading-spinner"></div>
            <div id="loading-message" class="loading-message">Loading...</div>
        </div>

        <!-- VS Code-style Notification Container -->
        <div id="notification-container" class="notification-container"></div>

        <!-- Global Search Command Palette -->
        <div id="global-search-overlay" class="global-search-overlay" style="display: none" role="dialog" aria-modal="true" aria-label="Global Search">
            <div class="global-search-container">
                <div class="global-search-input-wrapper">
                    <img src="icons/dark/search.svg" alt="" class="global-search-input-icon" id="global-search-input-icon" />
                    <input
                        type="text"
                        id="global-search-input"
                        class="global-search-input"
                        placeholder="Search tools, connections, settings..."
                        autocomplete="off"
                        spellcheck="false"
                        aria-label="Search tools, connections, and settings"
                    />
                    <kbd class="global-search-kbd">ESC</kbd>
                </div>
                <div class="global-search-results" id="global-search-results" role="listbox">
                    <!-- Results populated dynamically -->
                </div>
                <div class="global-search-footer">
                    <span><kbd>‚Üë</kbd><kbd>‚Üì</kbd> navigate</span>
                    <span><kbd>‚Üµ</kbd> select</span>
                    <span><kbd>ESC</kbd> close</span>
                </div>
            </div>
        </div>

        <script type="module" src="renderer.ts"></script>
    </body>
</html>
